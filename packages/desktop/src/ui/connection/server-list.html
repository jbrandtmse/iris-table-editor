<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="Content-Security-Policy" content="default-src 'none'; style-src 'self'; script-src 'self';">
    <title>IRIS Table Editor - Server List</title>
    <link rel="stylesheet" href="server-list.css">
    <link rel="stylesheet" href="server-form.css">
</head>
<body>
    <div class="ite-sidebar" role="complementary" aria-label="Server connections sidebar">
        <div class="ite-sidebar__header">
            <h2 class="ite-sidebar__title">Servers</h2>
            <button class="ite-button ite-button--icon" id="addServerBtn"
                    title="Add Server" aria-label="Add a new server connection">
                +
            </button>
        </div>
        <div class="ite-sidebar__content" id="serverListContainer">
            <!-- Server list or welcome screen rendered here by JS -->
        </div>
    </div>

    <!-- Context menu (hidden by default) -->
    <!-- Story 12.5: Added Disconnect option (hidden by default, shown when connected) -->
    <div class="ite-context-menu" id="contextMenu" role="menu" aria-label="Server actions" hidden>
        <button class="ite-context-menu__item" data-action="connect" role="menuitem">Connect</button>
        <button class="ite-context-menu__item" data-action="disconnect" role="menuitem" hidden>Disconnect</button>
        <button class="ite-context-menu__item" data-action="edit" role="menuitem">Edit</button>
        <button class="ite-context-menu__item" data-action="delete" role="menuitem">Delete</button>
        <div class="ite-context-menu__separator" role="separator"></div>
        <button class="ite-context-menu__item" data-action="testConnection" role="menuitem">Test Connection</button>
    </div>

    <!-- Server Form (Story 12.2) -->
    <!-- Form overlay and markup loaded from server-form.html inline -->
    <div class="ite-form-overlay" id="serverFormOverlay" hidden>
        <div class="ite-form" role="dialog" aria-labelledby="formTitle" aria-modal="true">
            <div class="ite-form__header">
                <h2 class="ite-form__title" id="formTitle">Add Server</h2>
                <button class="ite-button ite-button--icon ite-form__close"
                        id="formCloseBtn" title="Close" aria-label="Close form">&#10005;</button>
            </div>

            <form class="ite-form__body" id="serverForm" novalidate autocomplete="off">
                <!-- Server Name -->
                <div class="ite-form__field" data-field="name">
                    <label class="ite-form__label" for="fieldName">
                        Server Name <span class="ite-form__required" aria-hidden="true">*</span>
                    </label>
                    <input class="ite-form__input" type="text" id="fieldName" name="name"
                           required placeholder="e.g., My IRIS Server"
                           aria-required="true" aria-describedby="fieldNameError">
                    <span class="ite-form__error" id="fieldNameError" role="alert" aria-live="polite"></span>
                </div>

                <!-- Description -->
                <div class="ite-form__field" data-field="description">
                    <label class="ite-form__label" for="fieldDescription">Description</label>
                    <input class="ite-form__input" type="text" id="fieldDescription" name="description"
                           placeholder="Optional description">
                </div>

                <!-- Host -->
                <div class="ite-form__field" data-field="hostname">
                    <label class="ite-form__label" for="fieldHostname">
                        Host <span class="ite-form__required" aria-hidden="true">*</span>
                    </label>
                    <input class="ite-form__input" type="text" id="fieldHostname" name="hostname"
                           required placeholder="e.g., localhost or 192.168.1.100"
                           aria-required="true" aria-describedby="fieldHostnameError">
                    <span class="ite-form__error" id="fieldHostnameError" role="alert" aria-live="polite"></span>
                </div>

                <!-- Port -->
                <div class="ite-form__field" data-field="port">
                    <label class="ite-form__label" for="fieldPort">
                        Port <span class="ite-form__required" aria-hidden="true">*</span>
                    </label>
                    <input class="ite-form__input" type="number" id="fieldPort" name="port"
                           required value="52773" min="1" max="65535"
                           aria-required="true" aria-describedby="fieldPortError">
                    <span class="ite-form__error" id="fieldPortError" role="alert" aria-live="polite"></span>
                </div>

                <!-- Path Prefix -->
                <div class="ite-form__field" data-field="pathPrefix">
                    <label class="ite-form__label" for="fieldPathPrefix">Path Prefix</label>
                    <input class="ite-form__input" type="text" id="fieldPathPrefix" name="pathPrefix"
                           placeholder="e.g., /iris">
                </div>

                <!-- Use HTTPS -->
                <div class="ite-form__field ite-form__field--checkbox" data-field="ssl">
                    <label class="ite-form__checkbox-label">
                        <input class="ite-form__checkbox" type="checkbox" id="fieldSsl" name="ssl">
                        <span class="ite-form__checkbox-text">Use HTTPS</span>
                    </label>
                </div>

                <!-- Username -->
                <div class="ite-form__field" data-field="username">
                    <label class="ite-form__label" for="fieldUsername">
                        Username <span class="ite-form__required" aria-hidden="true">*</span>
                    </label>
                    <input class="ite-form__input" type="text" id="fieldUsername" name="username"
                           required placeholder="e.g., _SYSTEM"
                           aria-required="true" aria-describedby="fieldUsernameError">
                    <span class="ite-form__error" id="fieldUsernameError" role="alert" aria-live="polite"></span>
                </div>

                <!-- Password -->
                <div class="ite-form__field" data-field="password">
                    <label class="ite-form__label" for="fieldPassword">
                        Password <span class="ite-form__required" aria-hidden="true">*</span>
                    </label>
                    <input class="ite-form__input" type="password" id="fieldPassword" name="password"
                           required placeholder="Enter password"
                           aria-required="true" aria-describedby="fieldPasswordError">
                    <span class="ite-form__error" id="fieldPasswordError" role="alert" aria-live="polite"></span>
                </div>

                <!-- Form Actions -->
                <div class="ite-form__actions">
                    <button class="ite-button ite-button--secondary" type="button"
                            id="formCancelBtn">Cancel</button>
                    <button class="ite-button ite-button--primary" type="submit"
                            id="formSaveBtn">Save</button>
                </div>
            </form>
        </div>
    </div>

    <!-- ARIA live region for screen reader announcements -->
    <div id="ite-live-region" class="visually-hidden" aria-live="polite" aria-atomic="true"></div>
    <div id="ite-form-live-region" class="visually-hidden" aria-live="polite" aria-atomic="true"></div>

    <script src="server-form.js"></script>
    <script src="server-list.js"></script>
</body>
</html>
